(this.webpackJsonpbookswap=this.webpackJsonpbookswap||[]).push([[0],{78:function(e,t,s){},79:function(e,t,s){},80:function(e,t,s){},81:function(e,t,s){"use strict";s.r(t);var c=s(0),a=s(1),n=s(18),i=s.n(n),l=s(2),o=s(3),r=s(10),d=s.n(r);var j=()=>Object(c.jsxs)("div",{className:"welcome",children:[Object(c.jsx)("h2",{className:"my-5 text-center",children:"Welcome to Book Swap"}),Object(c.jsx)("p",{children:"Find a free book"})]});var b=()=>Object(c.jsxs)("footer",{className:"bg-light p-3 text-center",children:[Object(c.jsx)("br",{}),Object(c.jsx)("p",{children:"BookSwap by Kombe Kampanga"})]});var h=()=>Object(c.jsx)("div",{className:"spinner",children:Object(c.jsx)("img",{src:"../../../images/loading.gif",alt:"Loading..."})}),u=s(8);var x=()=>Object(c.jsxs)("div",{className:"navbar-nav mr-auto",children:[Object(c.jsx)(u.b,{to:"/",exact:!0,className:"nav-link",activeClassName:"router-link-exact-active",children:"Home"}),Object(c.jsx)(u.b,{to:"/profile",exact:!0,className:"nav-link",activeClassName:"router-link-exact-active",children:"Profile"}),Object(c.jsx)(u.b,{to:"/listings",exact:!0,className:"nav-link",activeClassName:"router-link-exact-active",children:"All Listings"}),Object(c.jsx)(u.b,{to:"/mylistings",exact:!0,className:"nav-link",activeClassName:"router-link-exact-active",children:"My Listings"}),Object(c.jsx)(u.b,{to:"/listabook",exact:!0,className:"nav-link",activeClassName:"router-link-exact-active",children:"List a Book"}),Object(c.jsx)(u.b,{to:"/external-api",exact:!0,className:"nav-link",activeClassName:"router-link-exact-active",children:"External API"})]});var O=()=>{const{loginWithRedirect:e}=Object(o.b)();return Object(c.jsx)("button",{className:"btn btn-primary btn-block",onClick:()=>e(),children:"Log In"})};var m=()=>{const{logout:e}=Object(o.b)();return Object(c.jsx)("button",{className:"btn btn-danger btn-block",onClick:()=>e({returnTo:window.location.origin}),children:"Log Out"})};var v=()=>{const{isAuthenticated:e}=Object(o.b)();return e?Object(c.jsx)(m,{}):Object(c.jsx)(O,{})};var p=()=>Object(c.jsx)("div",{className:"navbar-nav ml-auto",children:Object(c.jsx)(v,{})});var g=()=>Object(c.jsx)("div",{className:"nav-container mb-3",children:Object(c.jsx)("nav",{className:"navbar navbar-expand-md navbar-light bg-light",children:Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("div",{className:"navbar-brand logo"}),Object(c.jsx)(x,{}),Object(c.jsx)(p,{})]})})});var k=()=>Object(c.jsxs)(a.Fragment,{children:[Object(c.jsx)("hr",{}),Object(c.jsx)(j,{})]});const N=()=>{const{user:e}=Object(o.b)();console.log(e);const{name:t,picture:s,email:a}=e;return Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"row align-items-center profile-header",children:[Object(c.jsx)("div",{className:"col-md-2 mb-3",children:Object(c.jsx)("img",{src:s,alt:"Profile",className:"rounded-circle img-fluid profile-picture mb-3 mb-md-0"})}),Object(c.jsxs)("div",{className:"col-md text-center text-md-left",children:[Object(c.jsx)("h2",{children:t}),Object(c.jsx)("p",{className:"lead text-muted",children:a})]})]}),Object(c.jsx)("div",{className:"row",children:Object(c.jsx)("pre",{className:"col-12 text-light bg-dark p-4",children:JSON.stringify(e,null,2)})})]})},y=()=>{const{user:e}=Object(o.b)(),[t,s]=Object(a.useState)([]);return Object(a.useEffect)((()=>{d.a.get("http://localhost:6060/api/listings/get").then((e=>{s(e.data)}))}),[]),Object(c.jsx)("div",{children:t.map((e=>Object(c.jsxs)("div",{className:"card",children:[Object(c.jsx)("h1",{children:e.title}),Object(c.jsxs)("h4",{children:["By ",e.author]}),Object(c.jsx)("h5",{children:e.genres}),Object(c.jsxs)("p",{children:["Listed by ",e.userEmail]})]})))})};var f=s(21),w=s.n(f);s(78);w.a.setAppElement("#root");const C=()=>{const{user:e,getAccessTokenSilently:t}=Object(o.b)();if(void 0!=e){var s;const n="http://localhost:6060",i=null===(s=e.sub)||void 0===s?void 0:s.split("|")[1],{name:l,picture:o,email:r}=e,[j,b]=Object(a.useState)([]),[h,u]=Object(a.useState)(!1),[x,O]=Object(a.useState)(),[m,v]=Object(a.useState)(""),[p,g]=Object(a.useState)(""),[k,N]=Object(a.useState)(""),y=async()=>{const e=await t();d.a.get(n+"/api/listings/my-listings/get",{params:{userId:i},headers:{Authorization:"Bearer ".concat(e)}}).then((e=>{b(e.data)})).catch((e=>{console.log(e.response),alert(e.response.data)}))};Object(a.useEffect)((()=>{y()}),[]);const f=async e=>{const s=await t();console.log(e),d.a.delete(n+"/api/listings/my-listings/delete/",{data:{userId:i,bookId:e},headers:{Authorization:"Bearer ".concat(s)}}).then((()=>{u(!1),O(void 0),alert("Listing Deleted"),window.location.reload()})).catch((e=>{console.log(e.response),alert(e.response.data)}))},C=e=>{O(e),u(!0),v(e.title),g(e.author),N(e.genre)},A=async e=>{const s=await t();console.log(e),d.a.put(n+"/api/listings/my-listings/update",{userId:i,bookId:e,bookTitle:m,bookAuthor:p,bookGenre:k},{headers:{Authorization:"Bearer ".concat(s)}}).then((()=>{alert(m+" listing updated"),v(""),g(""),N(""),u(!1),O(void 0),window.location.reload()})).catch((e=>{console.log(e.response),alert(e.response.data)}))};return Object(c.jsxs)("div",{className:"myListings",children:[j.map((e=>Object(c.jsxs)("div",{className:"card",children:[Object(c.jsx)("h1",{children:e.title}),Object(c.jsxs)("h4",{children:["By ",e.author]}),Object(c.jsx)("p",{children:e.genres}),Object(c.jsxs)("div",{id:"editListing",children:[Object(c.jsx)("button",{onClick:()=>{C(e)},children:"Edit"}),Object(c.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this listing for "+e.title+"?")?(console.log("Confirmed deletion"),f(e.id)):console.log("pressed cancel")},children:"Delete"})]})]}))),h&&Object(c.jsx)("div",{className:"modalBackground",children:Object(c.jsxs)(w.a,{isOpen:h,contentLabel:"My dialog",className:"mymodal",overlayClassName:"myoverlay",children:[Object(c.jsx)("div",{className:"xModalBtn",children:Object(c.jsx)("button",{onClick:()=>{u(!1),O(void 0)},children:"X"})}),Object(c.jsx)("div",{className:"modalTitle",children:Object(c.jsx)("h1",{children:"Edit Your Listing"})}),Object(c.jsxs)("div",{className:"modalBody",children:[Object(c.jsx)("label",{children:"Title:"}),Object(c.jsx)("input",{type:"text",name:"Title",defaultValue:null===x||void 0===x?void 0:x.title,onChange:e=>{v(e.target.value)}}),Object(c.jsx)("label",{children:"Author:"}),Object(c.jsx)("input",{type:"text",name:"Author",defaultValue:null===x||void 0===x?void 0:x.author,onChange:e=>{g(e.target.value)}}),Object(c.jsx)("label",{children:"Genre:"}),Object(c.jsx)("input",{type:"text",name:"Genre",defaultValue:null===x||void 0===x?void 0:x.genres,onChange:e=>{N(e.target.value)}})]}),Object(c.jsxs)("div",{className:"modalFooter",children:[Object(c.jsx)("button",{onClick:()=>{u(!1),O(void 0)},children:"Cancel"}),Object(c.jsx)("button",{onClick:()=>{A(null===x||void 0===x?void 0:x.id)},children:"Save"}),Object(c.jsx)("button",{id:"deleteBtn",onClick:()=>{window.confirm("Are you sure you want to delete this listing for "+(null===x||void 0===x?void 0:x.title)+"?")&&void 0!=(null===x||void 0===x?void 0:x.id)?(console.log("Confirmed deletion"),f(null===x||void 0===x?void 0:x.id)):console.log("pressed cancel")},children:"Delete Listing"})]})]})})]})}},A=()=>{const{user:e,getAccessTokenSilently:t}=Object(o.b)();if(void 0!=e){var s;const{name:n,picture:i,email:l}=e,o=null===(s=e.sub)||void 0===s?void 0:s.split("|")[1],r="http://localhost:6060",[j,b]=Object(a.useState)(""),[h,u]=Object(a.useState)(""),[x,O]=Object(a.useState)(""),[m,v]=Object(a.useState)([]),p=async()=>{const e=await t();d.a.get(r+"/api/listings/my-listings/get",{params:{userId:o},headers:{Authorization:"Bearer ".concat(e)}}).then((e=>{v(e.data)})).catch((e=>{console.log(e.response),alert(e.response.data)}))};Object(a.useEffect)((()=>{p()}),[]);const g=async()=>{const e=await t();d.a.post(r+"/api/listings/my-listings/insert",{userId:o,userEmail:l,bookTitle:j,bookAuthor:h,bookGenre:x},{headers:{Authorization:"Bearer ".concat(e)}}).then((()=>{alert("Listing Added"),window.location.reload()})).catch((e=>{console.log(e.response),alert(e.response.data)}))};return Object(c.jsxs)("div",{className:"listabook",children:[Object(c.jsx)("h1",{children:"List a Book"}),Object(c.jsxs)("div",{className:"form",children:[Object(c.jsx)("label",{children:"Title:"}),Object(c.jsx)("input",{type:"text",name:"Title",onChange:e=>b(e.target.value)}),Object(c.jsx)("label",{children:"Author:"}),Object(c.jsx)("input",{type:"text",name:"Author",onChange:e=>u(e.target.value)}),Object(c.jsx)("label",{children:"Genre:"}),Object(c.jsx)("input",{type:"text",name:"Genre",onChange:e=>O(e.target.value)}),Object(c.jsx)("button",{onClick:g,children:"Submit"}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)("h1",{children:"My Listings"}),Object(c.jsx)("br",{}),m.map((e=>Object(c.jsxs)("div",{className:"card",children:[Object(c.jsx)("h1",{children:e.title}),Object(c.jsxs)("h4",{children:["By ",e.author]}),Object(c.jsx)("p",{children:e.genres})]})))]})]})}};s(79);var S=e=>{let{component:t,...s}=e;return Object(c.jsx)(l.a,{component:Object(o.c)(t,{onRedirecting:()=>Object(c.jsx)(h,{})}),...s})};var B=()=>{const{user:e,isAuthenticated:t,getAccessTokenSilently:s}=Object(o.b)();return t&&(async()=>{var t;const c=await s(),a=null===e||void 0===e||null===(t=e.sub)||void 0===t?void 0:t.split("|")[1],n=null===e||void 0===e?void 0:e.email;d.a.post("http://localhost:6060/api/users/insert",{userId:a,userEmail:n},{headers:{Authorization:"Bearer ".concat(c)}}).then((e=>{0!=e.data.affectedRows&&alert("User Added")})).catch((e=>{console.log(e),alert(e.response.data)}))})(),Object(c.jsxs)("div",{id:"app",className:"d-flex flex-column h-100",children:[Object(c.jsx)(g,{}),Object(c.jsx)("div",{className:"container flex-grow-1",children:Object(c.jsx)("div",{className:"mt-5",children:Object(c.jsxs)(l.c,{children:[Object(c.jsx)(l.a,{path:"/",exact:!0,component:k}),Object(c.jsx)(S,{path:"/profile",component:N}),Object(c.jsx)(l.a,{path:"/listings",component:y}),Object(c.jsx)(S,{path:"/listabook",component:A}),Object(c.jsx)(S,{path:"/mylistings",component:C})]})})}),Object(c.jsx)(b,{})]})};var L=e=>{let{children:t}=e;const s="book-swap.au.auth0.com",a="4KmzURdTfAZmFLr9wyzqCLS5eTPp80x8",n=Object(l.f)(),i=e=>{n.push((null===e||void 0===e?void 0:e.returnTo)||window.location.pathname)};return Object(c.jsx)(o.a,{domain:s,clientId:a,redirectUri:window.location.origin,onRedirectCallback:i,audience:"http://bookswap-api",children:t})};s(80);i.a.render(Object(c.jsx)(u.a,{children:Object(c.jsx)(L,{children:Object(c.jsx)(B,{})})}),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.a8f9a5e6.chunk.js.map